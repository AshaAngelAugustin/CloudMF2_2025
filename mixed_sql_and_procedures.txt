-- Mixed SQL and Stored Procedure Content
-- Basic SQL statements
CREATE TABLE products (
    id INT IDENTITY(1,1),
    name VARCHAR(100),
    price DECIMAL(10,2),
    created_date DATETIME DEFAULT GETDATE()
);

-- Sample stored procedure
CREATE PROCEDURE GetProducts (
    OUT ProductCount INT
)
BEGIN
    DECLARE prod_cursor CURSOR FOR
        SELECT id, name, price 
        FROM products 
        WHERE price > 100;
    
    DECLARE current_id INT;
    DECLARE current_name CHAR(100);
    SET ProductCount = 0;
    
    OPEN prod_cursor;
    
    ProductLoop:
    LOOP
        FETCH NEXT prod_cursor INTO current_id, current_name;
        IF SQLSTATE = '02000' THEN
            LEAVE ProductLoop;
        END IF;
        SET ProductCount = ProductCount + 1;
    END LOOP ProductLoop;
    
    CLOSE prod_cursor;
END;

-- More basic SQL
SELECT TOP 5 * FROM products WHERE price >= 50.00;
INSERT INTO products (name, price) VALUES ('Test Product', 99.99);
